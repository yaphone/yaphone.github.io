<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>itchat4j -- 用Java扩展个人微信号的能力 | yaphone</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="项目地址：itchat4j，该项目长期维护更新，欢迎star、fork、 pull requests、 issue。示例项目程序点击此处下载。来源itchat是一个非常优秀的开源微信个人号接口，使用Python语言开发，提供了简单易用的API，可以很方便地对个人微信号进行扩展，实现自动回复，微信挂机机器人等，一直在关注这个项目，基于itchat开发过一个小项目，用来控制我的树莓派来播放音乐，效果还">
<meta property="og:type" content="article">
<meta property="og:title" content="itchat4j -- 用Java扩展个人微信号的能力">
<meta property="og:url" content="http://yoursite.com/2017/06/10/itchat4j/index.html">
<meta property="og:site_name" content="yaphone">
<meta property="og:description" content="项目地址：itchat4j，该项目长期维护更新，欢迎star、fork、 pull requests、 issue。示例项目程序点击此处下载。来源itchat是一个非常优秀的开源微信个人号接口，使用Python语言开发，提供了简单易用的API，可以很方便地对个人微信号进行扩展，实现自动回复，微信挂机机器人等，一直在关注这个项目，基于itchat开发过一个小项目，用来控制我的树莓派来播放音乐，效果还">
<meta property="og:image" content="http://oj5vdtyuu.bkt.clouddn.com/itchat4j%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%842.png">
<meta property="og:image" content="http://oj5vdtyuu.bkt.clouddn.com/windows%E5%8F%AF%E8%BF%90%E8%A1%8C%E7%A8%8B%E5%BA%8F.png">
<meta property="og:image" content="http://oj5vdtyuu.bkt.clouddn.com/%E5%BE%AE%E4%BF%A1%E6%9C%BA%E5%99%A8%E4%BA%BA.jpg">
<meta property="og:image" content="http://oj5vdtyuu.bkt.clouddn.com/%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%94%B6%E5%88%B0%E7%9A%84%E6%B6%88%E6%81%AF.png">
<meta property="og:image" content="http://oj5vdtyuu.bkt.clouddn.com/itchat4j%E9%9B%86%E6%88%90%E5%9C%A8blog%E9%A1%B9%E7%9B%AE%E4%B8%AD%E4%BF%AE%E6%94%B9%E5%90%8E.jpg">
<meta property="og:updated_time" content="2017-06-08T16:52:49.918Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="itchat4j -- 用Java扩展个人微信号的能力">
<meta name="twitter:description" content="项目地址：itchat4j，该项目长期维护更新，欢迎star、fork、 pull requests、 issue。示例项目程序点击此处下载。来源itchat是一个非常优秀的开源微信个人号接口，使用Python语言开发，提供了简单易用的API，可以很方便地对个人微信号进行扩展，实现自动回复，微信挂机机器人等，一直在关注这个项目，基于itchat开发过一个小项目，用来控制我的树莓派来播放音乐，效果还">
<meta name="twitter:image" content="http://oj5vdtyuu.bkt.clouddn.com/itchat4j%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%842.png">
  
    <link rel="alternate" href="/atom.xml" title="yaphone" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">yaphone</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="Flux RSS"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Rechercher"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-itchat4j" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/06/10/itchat4j/" class="article-date">
  <time datetime="2017-06-10T03:17:04.797Z" itemprop="datePublished">2017-06-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      itchat4j -- 用Java扩展个人微信号的能力
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="项目地址：itchat4j，该项目长期维护更新，欢迎star、fork、-pull-requests、-issue。"><a href="#项目地址：itchat4j，该项目长期维护更新，欢迎star、fork、-pull-requests、-issue。" class="headerlink" title="项目地址：itchat4j，该项目长期维护更新，欢迎star、fork、 pull requests、 issue。"></a>项目地址：<a href="https://github.com/yaphone/itchat4j" target="_blank" rel="external">itchat4j</a>，该项目长期维护更新，欢迎star、fork、 pull requests、 issue。</h3><h2 id="示例项目程序点击此处下载。"><a href="#示例项目程序点击此处下载。" class="headerlink" title="示例项目程序点击此处下载。"></a>示例项目程序<a href="https://github.com/yaphone/itchat4jdemo" target="_blank" rel="external">点击此处下载</a>。</h2><h3 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h3><p><a href="https://github.com/littlecodersh/ItChat" target="_blank" rel="external">itchat</a>是一个非常优秀的开源微信个人号接口，使用Python语言开发，提供了简单易用的API，可以很方便地对个人微信号进行扩展，实现自动回复，微信挂机机器人等，一直在关注这个项目，基于itchat开发过<a href="https://github.com/yaphone/RasWxNeteaseMusic" target="_blank" rel="external">一个小项目</a>，用来控制我的树莓派来播放音乐，效果还不错。</p>
<p>一直想实现一个java版本的itchat，由于工作太忙导致一拖再拖，这段时间稍微空闲了一些，仔细阅读了itchat的源码，终于完成了一个基础版本，由于主要灵感来源于itchat项目，所以这个项目的就暂时定名为<a href="https://github.com/yaphone/itchat4j" target="_blank" rel="external">itchat4j</a>吧。</p>
<h2 id="项目介绍"><a href="#项目介绍" class="headerlink" title="项目介绍"></a>项目介绍</h2><blockquote>
<p>itchat是一个开源的微信个人号接口，使用Python调用微信从未如此简单。使用短短的几十行代码，你就可以完成一个能够处理所有信息的微信机器人。当然，itchat的使用远不止一个机器人，更多的功能等着你来发现，如今微信已经成为了个人社交的很大一部分，希望这个项目能够帮助你扩展你的个人的微信号、方便自己的生活。(引自itchat项目)</p>
</blockquote>
<p>你可以轻松将<a href="https://github.com/yaphone/itchat4j" target="_blank" rel="external">itchat4j</a>其集成在你个人的Java应用中，无论是SpringMVC、桌面程序还是嵌入式程序，只要使用的JDK是1.6以上的版本，都可以轻松接入。玩法很多，请打开你的脑洞，比如这些：</p>
<ul>
<li>Just for fun，把个人微信号扩展为”公众号”，在朋友面前装个X吧。</li>
<li>集成在你的个人应用（SpringMVC、Serverlet、GUI）中，为应用提供更强的服务能力。</li>
<li>部署在你的服务器上，将监控信息、日志发送到你的微信号。</li>
<li>微信机器人，专业陪聊工具</li>
<li>控制树莓派、智能家居、智能硬件等具有开放接口的设备</li>
<li>Anything you want …</li>
</ul>
<h2 id="API说明"><a href="#API说明" class="headerlink" title="API说明"></a>API说明</h2><p><em>项目在不断更新中，API会有变动，请以具体代码为准</em></p>
<p>目前在<code>package cn.zhouyafeng.itchat4j.api</code>包中有两个静态类，即<code>MessageTools</code>和<code>WechatTools</code>，目前对外暴露的方法有：</p>
<h4 id="1-获取好友列表-WechatTools-getContactList"><a href="#1-获取好友列表-WechatTools-getContactList" class="headerlink" title="1.获取好友列表  WechatTools.getContactList()"></a>1.获取好友列表  WechatTools.getContactList()</h4><p>此方法会返回好友昵称列表，其函数声明为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static List&lt;String&gt; getContactList()</div></pre></td></tr></table></figure>
<h4 id="2-获取群列表-WechatTools-getGroupIdList"><a href="#2-获取群列表-WechatTools-getGroupIdList" class="headerlink" title="2.获取群列表 WechatTools.getGroupIdList()"></a>2.获取群列表 WechatTools.getGroupIdList()</h4><p>群列表与好友列表不同，在登陆后群列表其实是空的，只有主动发送消息或者收到一条群消息时，才能获取到这个群的信息，群列表会记录这个群的id，其格式为<code>@@d052d34b9c9228830363013ee53deb461404f80ea353dbdd8fc9391cbf5f1c46</code>。调用此方法会返回已知的群列表。其声明函数为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static List&lt;String&gt; getGroupIdList()</div></pre></td></tr></table></figure>
<h4 id="3-退出微信-WechatTools-logout"><a href="#3-退出微信-WechatTools-logout" class="headerlink" title="3.退出微信 WechatTools.logout()"></a>3.退出微信 WechatTools.logout()</h4><p>退出itchat4j，不再处理消息，其函数声明为:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static void logout()</div></pre></td></tr></table></figure>
<h4 id="4-根据用户昵称修改用户备注MessageTools-remarkNameByNickName-String-nickName-String-remName"><a href="#4-根据用户昵称修改用户备注MessageTools-remarkNameByNickName-String-nickName-String-remName" class="headerlink" title="4.根据用户昵称修改用户备注MessageTools.remarkNameByNickName(String nickName, String remName)"></a>4.根据用户昵称修改用户备注MessageTools.remarkNameByNickName(String nickName, String remName)</h4><p>根据用户昵称修改用户备注名称，其函数声明为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static void remarkNameByNickName(String nickName, String remName)</div></pre></td></tr></table></figure>
<h4 id="5-根据好友昵称发送文本消息，MessageTools-sendMsgByNickName-String-text-String-nickName"><a href="#5-根据好友昵称发送文本消息，MessageTools-sendMsgByNickName-String-text-String-nickName" class="headerlink" title="5. 根据好友昵称发送文本消息，MessageTools.sendMsgByNickName(String text, String nickName)"></a>5. 根据好友昵称发送文本消息，MessageTools.sendMsgByNickName(String text, String nickName)</h4><p>此方法根据用户昵称发送文本消息，注意，用户需在你的好友列表里，否则发送失败，如果你的好友列表里有存在昵称一样的多个用户，则只会给第一个匹配的好友发送消息。方法接受两个参数，<code>text</code>为要发送的文本消息，<code>nickName</code>为要发送消息的好友昵称，成功发送时返回true，失败返回false。其函数声明为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static boolean sendMsgByNickName(String text, String nickName)</div></pre></td></tr></table></figure>
<h4 id="6-根据ID发送文本消息，-MessageTools-sendMsgById-String-text-String-id"><a href="#6-根据ID发送文本消息，-MessageTools-sendMsgById-String-text-String-id" class="headerlink" title="6.根据ID发送文本消息， MessageTools.sendMsgById(String text, String id)"></a>6.根据ID发送文本消息， MessageTools.sendMsgById(String text, String id)</h4><p>根据ID发送文本消息，发送者ID可以从<code>msg</code>里通过<code>msg.getString(&quot;FromUserName&quot;)</code>获取，格式为<code>@@d052d34b9c9228830363013ee53deb461404f80ea353dbdd8fc9391cbf5f1c46</code>（群消息）或<code>@a257b99314d8313862cd44ab02fe0f81</code>（非群消息），调用此方法可向指定id发送消息。其函数声明为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static void sendMsgById(String text, String id)</div></pre></td></tr></table></figure>
<h4 id="7-根据好友昵称发送图片消息，MessageTools-sendPicMsgByNickName-String-nickName-String-filePath"><a href="#7-根据好友昵称发送图片消息，MessageTools-sendPicMsgByNickName-String-nickName-String-filePath" class="headerlink" title="7.根据好友昵称发送图片消息，MessageTools.sendPicMsgByNickName(String nickName, String filePath)"></a>7.根据好友昵称发送图片消息，MessageTools.sendPicMsgByNickName(String nickName, String filePath)</h4><p>此方法根据好友昵称发送图片消息，<code>filePath</code>为图片文件路径，如<code>D:/itchat4j/pic/test.jpg</code>，成功返回true，失败返回false。其函数声明为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static boolean sendPicMsgByNickName(String nickName, String filePath)</div></pre></td></tr></table></figure>
<h4 id="8-根据ID发送图片消息，MessageTools-sendPicMsgByUserId-String-userId-String-filePath"><a href="#8-根据ID发送图片消息，MessageTools-sendPicMsgByUserId-String-userId-String-filePath" class="headerlink" title="8.根据ID发送图片消息，MessageTools.sendPicMsgByUserId(String userId, String filePath)"></a>8.根据ID发送图片消息，MessageTools.sendPicMsgByUserId(String userId, String filePath)</h4><p>此方法根据好友ID发送图片消息，filePath<code>为图片文件路径，如</code>D:/itchat4j/pic/test.jpg`，成功返回true，失败返回false。其函数声明为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static boolean sendPicMsgByUserId(String userId, String filePath)</div></pre></td></tr></table></figure>
<h4 id="9-根据好友昵称发送文件消息，MessageTools-sendFileMsgByNickName-String-nickName-String-filePath"><a href="#9-根据好友昵称发送文件消息，MessageTools-sendFileMsgByNickName-String-nickName-String-filePath" class="headerlink" title="9.根据好友昵称发送文件消息，MessageTools.sendFileMsgByNickName(String nickName, String filePath)"></a>9.根据好友昵称发送文件消息，MessageTools.sendFileMsgByNickName(String nickName, String filePath)</h4><p>此方法根据好友昵称发送文件消息，文件可以为多种类型，如txt、PDF、小视频、语音、excel、docx等，发送时请保证文件后缀名正确。成功返回true，失败返回false。其函数声明为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static boolean sendPicFileByNickName(String nickName, String filePath)</div></pre></td></tr></table></figure>
<h4 id="10-根据ID发送文件消息，MessageTools-sendFileMsgByNickName-String-nickName-String-filePath"><a href="#10-根据ID发送文件消息，MessageTools-sendFileMsgByNickName-String-nickName-String-filePath" class="headerlink" title="10.根据ID发送文件消息，MessageTools.sendFileMsgByNickName(String nickName, String filePath)"></a>10.根据ID发送文件消息，MessageTools.sendFileMsgByNickName(String nickName, String filePath)</h4><p>此方法根据好友昵称发送文件消息，成功返回true，失败返回false。其函数声明为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static boolean sendFileMsgByUserId(String userId, String filePath)</div></pre></td></tr></table></figure>
<h2 id="TODO-List-即将支持-正在开发"><a href="#TODO-List-即将支持-正在开发" class="headerlink" title="TODO List 即将支持/正在开发"></a>TODO List 即将支持/正在开发</h2><ul>
<li>根据userId获取用户的详细信息</li>
<li>获取群成员列表</li>
<li>拉人进群功能</li>
</ul>
<h2 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h2><p><em>项目在不断更新中，导入后的项目结构会有变动</em></p>
<p>itchat4j是一个Maven项目，下载源码后，可以以Maven项目的形式导入，导入后的项目结构如下图:</p>
<p><img src="http://oj5vdtyuu.bkt.clouddn.com/itchat4j%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%842.png" alt="itchat4j项目结构"></p>
<p>src/main/java是itchat4j的项目源码，在src/test/java目录下有两个小Demo：一个是基本功能的小示例，当前，itchat4j可以处理四类基本信息，文本、语音、图片和小视频，该示例在收到文本信息后自动回复，回复内容为收到的文本，当收到图片、语音、小视频时可以保存到指定的目录；一个是微信接入图灵机器人的小例子，如下图。</p>
<h3 id="微信机器人使用截图"><a href="#微信机器人使用截图" class="headerlink" title="微信机器人使用截图"></a>微信机器人使用截图</h3><p><img src="http://oj5vdtyuu.bkt.clouddn.com/windows%E5%8F%AF%E8%BF%90%E8%A1%8C%E7%A8%8B%E5%BA%8F.png" alt="Windows控制台"></p>
<p><img src="http://oj5vdtyuu.bkt.clouddn.com/%E5%BE%AE%E4%BF%A1%E6%9C%BA%E5%99%A8%E4%BA%BA.jpg" alt="微信机器人"></p>
<p><img src="http://oj5vdtyuu.bkt.clouddn.com/%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%94%B6%E5%88%B0%E7%9A%84%E6%B6%88%E6%81%AF.png" alt="控制台收到的消息"></p>
<h2 id="消息格式"><a href="#消息格式" class="headerlink" title="消息格式"></a>消息格式</h2><p>这里简要介绍一下<code>msg</code>各种消息，msg均为<code>json</code>格式的数据，可使用各自工具进行解析，在itchat4j中我通过alibaba的<code>fastjosn</code>工具库进行了解析，每种<code>msg</code>均为<code>fastjson</code>的标准<code>JSONObject</code>对象，后续处理起来非常方便，例如获取文本消息的消息内容：<code>msg.getString(&quot;Text&quot;)</code>，获取名片消息的被推荐人昵称：<code>msg.getJSONObject(&quot;RecommendInfo&quot;).getString(&quot;NickName&quot;)</code>。有时候可能不需要处理群消息，因此在构造<code>msg</code>消息体里我添加了一个判断是否群消息的字段<code>groupMsg</code>，可通过<code>msg.getBoolean(&quot;groupMsg&quot;)</code>获取字段的值，如果是群消息，返回true，如果非群消息，返回false。</p>
<h3 id="1-文本消息"><a href="#1-文本消息" class="headerlink" title="1.文本消息"></a>1.文本消息</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"SubMsgType"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"VoiceLength"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"FileName"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"ImgHeight"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"ToUserName"</span>: <span class="string">"@58b8651e056f8937f7a4eaa386be0c16d2583a0fdb5741b874cedffe3e13e723"</span>,</div><div class="line">    <span class="attr">"HasProductId"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"ImgStatus"</span>: <span class="number">1</span>,</div><div class="line">    <span class="attr">"Url"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"ImgWidth"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"ForwardFlag"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"Status"</span>: <span class="number">3</span>,</div><div class="line">    <span class="attr">"Ticket"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"RecommendInfo"</span>: &#123;</div><div class="line">        <span class="attr">"Ticket"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"UserName"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Sex"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"AttrStatus"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"City"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"NickName"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Scene"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"Province"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Content"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Alias"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Signature"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"OpCode"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"QQNum"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"VerifyFlag"</span>: <span class="number">0</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"CreateTime"</span>: <span class="number">1494079411</span>,</div><div class="line">    <span class="attr">"NewMsgId"</span>: <span class="number">6942811558026846000</span>,</div><div class="line">    <span class="attr">"Text"</span>: <span class="string">"你好"</span>,</div><div class="line">    <span class="attr">"MsgType"</span>: <span class="number">1</span>,</div><div class="line">    <span class="attr">"groupMsg"</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">"MsgId"</span>: <span class="string">"6942811558026845859"</span>,</div><div class="line">    <span class="attr">"StatusNotifyCode"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"AppInfo"</span>: &#123;</div><div class="line">        <span class="attr">"Type"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"AppID"</span>: <span class="string">""</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"AppMsgType"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"Type"</span>: <span class="string">"Text"</span>,</div><div class="line">    <span class="attr">"PlayLength"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"MediaId"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"Content"</span>: <span class="string">"你好"</span>,</div><div class="line">    <span class="attr">"StatusNotifyUserName"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"FromUserName"</span>: <span class="string">"@a257b99314d8313862cd44ab02fe0f81"</span>,</div><div class="line">    <span class="attr">"OriContent"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"FileSize"</span>: <span class="string">""</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="图片消息"><a href="#图片消息" class="headerlink" title="图片消息"></a>图片消息</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"SubMsgType"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"VoiceLength"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"FileName"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"ImgHeight"</span>: <span class="number">120</span>,</div><div class="line">    <span class="attr">"ToUserName"</span>: <span class="string">"@58b8651e056f8937f7a4eaa386be0c16d2583a0fdb5741b874cedffe3e13e723"</span>,</div><div class="line">    <span class="attr">"HasProductId"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"ImgStatus"</span>: <span class="number">2</span>,</div><div class="line">    <span class="attr">"Url"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"ImgWidth"</span>: <span class="number">90</span>,</div><div class="line">    <span class="attr">"ForwardFlag"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"Status"</span>: <span class="number">3</span>,</div><div class="line">    <span class="attr">"Ticket"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"RecommendInfo"</span>: &#123;</div><div class="line">        <span class="attr">"Ticket"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"UserName"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Sex"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"AttrStatus"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"City"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"NickName"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Scene"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"Province"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Content"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Alias"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Signature"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"OpCode"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"QQNum"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"VerifyFlag"</span>: <span class="number">0</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"CreateTime"</span>: <span class="number">1494079495</span>,</div><div class="line">    <span class="attr">"NewMsgId"</span>: <span class="number">6081337643309445000</span>,</div><div class="line">    <span class="attr">"MsgType"</span>: <span class="number">3</span>,</div><div class="line">    <span class="attr">"groupMsg"</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">"MsgId"</span>: <span class="string">"6081337643309445027"</span>,</div><div class="line">    <span class="attr">"StatusNotifyCode"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"AppInfo"</span>: &#123;</div><div class="line">        <span class="attr">"Type"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"AppID"</span>: <span class="string">""</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"AppMsgType"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"Type"</span>: <span class="string">"Pic"</span>,</div><div class="line">    <span class="attr">"PlayLength"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"MediaId"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"Content"</span>: <span class="string">"&amp;lt;?xml version=\"1.0\"?&amp;gt;\n&amp;lt;msg&amp;gt;\n\t&amp;lt;img aeskey=\"2384ec2f417e4066a23522635d76b86a\" encryver=\"0\" cdnthumbaeskey=\"2384ec2f417e4066a23522635d76b86a\" cdnthumburl=\"3050020100044930470201000204577f6a2c02030f48810204a5b88cb60204590cac9e0425617570696d675f633337313936633333656466343463635f313439343030323834363430340201000201000400\" cdnthumblength=\"12204\" cdnthumbheight=\"120\" cdnthumbwidth=\"90\" cdnmidheight=\"0\" cdnmidwidth=\"0\" cdnhdheight=\"0\" cdnhdwidth=\"0\" cdnmidimgurl=\"3050020100044930470201000204577f6a2c02030f48810204a5b88cb60204590cac9e0425617570696d675f633337313936633333656466343463635f313439343030323834363430340201000201000400\" length=\"139120\" md5=\"5a774ad813f40fb3ca81349d82101423\" /&amp;gt;\n&amp;lt;/msg&amp;gt;\n"</span>,</div><div class="line">    <span class="attr">"StatusNotifyUserName"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"FromUserName"</span>: <span class="string">"@a257b99314d8313862cd44ab02fe0f81"</span>,</div><div class="line">    <span class="attr">"OriContent"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"FileSize"</span>: <span class="string">""</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="语音消息"><a href="#语音消息" class="headerlink" title="语音消息"></a>语音消息</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"SubMsgType"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"VoiceLength"</span>: <span class="number">2112</span>,</div><div class="line">    <span class="attr">"FileName"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"ImgHeight"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"ToUserName"</span>: <span class="string">"@58b8651e056f8937f7a4eaa386be0c16d2583a0fdb5741b874cedffe3e13e723"</span>,</div><div class="line">    <span class="attr">"HasProductId"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"ImgStatus"</span>: <span class="number">1</span>,</div><div class="line">    <span class="attr">"Url"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"ImgWidth"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"ForwardFlag"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"Status"</span>: <span class="number">3</span>,</div><div class="line">    <span class="attr">"Ticket"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"RecommendInfo"</span>: &#123;</div><div class="line">        <span class="attr">"Ticket"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"UserName"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Sex"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"AttrStatus"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"City"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"NickName"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Scene"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"Province"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Content"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Alias"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Signature"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"OpCode"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"QQNum"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"VerifyFlag"</span>: <span class="number">0</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"CreateTime"</span>: <span class="number">1494079534</span>,</div><div class="line">    <span class="attr">"NewMsgId"</span>: <span class="number">1038534170192835800</span>,</div><div class="line">    <span class="attr">"MsgType"</span>: <span class="number">34</span>,</div><div class="line">    <span class="attr">"groupMsg"</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">"MsgId"</span>: <span class="string">"1038534170192835842"</span>,</div><div class="line">    <span class="attr">"StatusNotifyCode"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"AppInfo"</span>: &#123;</div><div class="line">        <span class="attr">"Type"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"AppID"</span>: <span class="string">""</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"AppMsgType"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"Type"</span>: <span class="string">"Voice"</span>,</div><div class="line">    <span class="attr">"PlayLength"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"MediaId"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"Content"</span>: <span class="string">"&amp;lt;msg&amp;gt;&amp;lt;voicemsg endflag=\"1\" cancelflag=\"0\" forwardflag=\"0\" voiceformat=\"4\" voicelength=\"2112\" length=\"4051\" bufid=\"291965468715843925\" clientmsgid=\"41393631336234386239346262373200302205050617d9115824727105\" fromusername=\"zyfandlzz\" /&amp;gt;&amp;lt;/msg&amp;gt;"</span>,</div><div class="line">    <span class="attr">"StatusNotifyUserName"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"FromUserName"</span>: <span class="string">"@a257b99314d8313862cd44ab02fe0f81"</span>,</div><div class="line">    <span class="attr">"OriContent"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"FileSize"</span>: <span class="string">""</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="小视频消息"><a href="#小视频消息" class="headerlink" title="小视频消息"></a>小视频消息</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"SubMsgType"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"VoiceLength"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"FileName"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"ImgHeight"</span>: <span class="number">540</span>,</div><div class="line">    <span class="attr">"ToUserName"</span>: <span class="string">"@58b8651e056f8937f7a4eaa386be0c16d2583a0fdb5741b874cedffe3e13e723"</span>,</div><div class="line">    <span class="attr">"HasProductId"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"ImgStatus"</span>: <span class="number">1</span>,</div><div class="line">    <span class="attr">"Url"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"ImgWidth"</span>: <span class="number">960</span>,</div><div class="line">    <span class="attr">"ForwardFlag"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"Status"</span>: <span class="number">3</span>,</div><div class="line">    <span class="attr">"Ticket"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"RecommendInfo"</span>: &#123;</div><div class="line">        <span class="attr">"Ticket"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"UserName"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Sex"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"AttrStatus"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"City"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"NickName"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Scene"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"Province"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Content"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Alias"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Signature"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"OpCode"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"QQNum"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"VerifyFlag"</span>: <span class="number">0</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"CreateTime"</span>: <span class="number">1494079644</span>,</div><div class="line">    <span class="attr">"NewMsgId"</span>: <span class="number">1478649195821152000</span>,</div><div class="line">    <span class="attr">"MsgType"</span>: <span class="number">43</span>,</div><div class="line">    <span class="attr">"groupMsg"</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">"MsgId"</span>: <span class="string">"1478649195821152019"</span>,</div><div class="line">    <span class="attr">"StatusNotifyCode"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"AppInfo"</span>: &#123;</div><div class="line">        <span class="attr">"Type"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"AppID"</span>: <span class="string">""</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"AppMsgType"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"Type"</span>: <span class="string">"Video"</span>,</div><div class="line">    <span class="attr">"PlayLength"</span>: <span class="number">2</span>,</div><div class="line">    <span class="attr">"MediaId"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"Content"</span>: <span class="string">"&amp;lt;?xml version=\"1.0\"?&amp;gt;\n&amp;lt;msg&amp;gt;\n\t&amp;lt;videomsg aeskey=\"d9770f7f38f04888a96f95faa548dbd8\" cdnthumbaeskey=\"d9770f7f38f04888a96f95faa548dbd8\" cdnvideourl=\"30680201000461305f0201000204577f6a2c02032dcd0102041e0a96b60204590dd89c043d617570766964656f5f313530306338303339326430363161645f313439343037393634325f3232303731353036303531373331653863316435333233300201000201000400\" cdnthumburl=\"30680201000461305f0201000204577f6a2c02032dcd0102041e0a96b60204590dd89c043d617570766964656f5f313530306338303339326430363161645f313439343037393634325f3232303731353036303531373331653863316435333233300201000201000400\" length=\"328666\" playlength=\"2\" cdnthumblength=\"10398\" cdnthumbwidth=\"960\" cdnthumbheight=\"540\" fromusername=\"zyfandlzz\" md5=\"555c3efc0e065ba83c3fed942fea81b5\" newmd5=\"33389ec240de3e125f9f319c011781dd\" isad=\"0\" /&amp;gt;\n&amp;lt;/msg&amp;gt;\n"</span>,</div><div class="line">    <span class="attr">"StatusNotifyUserName"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"FromUserName"</span>: <span class="string">"@a257b99314d8313862cd44ab02fe0f81"</span>,</div><div class="line">    <span class="attr">"OriContent"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"FileSize"</span>: <span class="string">""</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="名片消息"><a href="#名片消息" class="headerlink" title="名片消息"></a>名片消息</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"SubMsgType"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"VoiceLength"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"FileName"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"ImgHeight"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"ToUserName"</span>: <span class="string">"@58b8651e056f8937f7a4eaa386be0c16d2583a0fdb5741b874cedffe3e13e723"</span>,</div><div class="line">    <span class="attr">"HasProductId"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"ImgStatus"</span>: <span class="number">1</span>,</div><div class="line">    <span class="attr">"Url"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"ImgWidth"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"ForwardFlag"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"Status"</span>: <span class="number">3</span>,</div><div class="line">    <span class="attr">"Ticket"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"RecommendInfo"</span>: &#123;</div><div class="line">        <span class="attr">"Ticket"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"UserName"</span>: <span class="string">"@173bd4ce01b725f327c221a06017260734d4607001d1dc82ba6b99c1ef77fb92"</span>,</div><div class="line">        <span class="attr">"Sex"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"AttrStatus"</span>: <span class="number">32</span>,</div><div class="line">        <span class="attr">"City"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"NickName"</span>: <span class="string">"LittleCoder机器人"</span>,</div><div class="line">        <span class="attr">"Scene"</span>: <span class="number">17</span>,</div><div class="line">        <span class="attr">"Province"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Content"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Alias"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"Signature"</span>: <span class="string">""</span>,</div><div class="line">        <span class="attr">"OpCode"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"QQNum"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"VerifyFlag"</span>: <span class="number">0</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"CreateTime"</span>: <span class="number">1494079592</span>,</div><div class="line">    <span class="attr">"NewMsgId"</span>: <span class="number">6687290426846395000</span>,</div><div class="line">    <span class="attr">"MsgType"</span>: <span class="number">42</span>,</div><div class="line">    <span class="attr">"groupMsg"</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">"MsgId"</span>: <span class="string">"6687290426846395587"</span>,</div><div class="line">    <span class="attr">"StatusNotifyCode"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"AppInfo"</span>: &#123;</div><div class="line">        <span class="attr">"Type"</span>: <span class="number">0</span>,</div><div class="line">        <span class="attr">"AppID"</span>: <span class="string">""</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"AppMsgType"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"Type"</span>: <span class="string">"NameCard"</span>,</div><div class="line">    <span class="attr">"PlayLength"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"MediaId"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"Content"</span>: <span class="string">"&amp;lt;?xml version=\"1.0\"?&amp;gt;\n&amp;lt;msg bigheadimgurl=\"http://wx.qlogo.cn/mmhead/ver_1/ajX7IquRvt16WXDJYrYsBuGy5HoicQ1ibNbLKKHu744ic2WnxSaRtEQCgibSP8S2MdyIsqTWsKUUEZydsias9UR55nSQE7n6ibXChx4DQZQf5xh0M/0\" smallheadimgurl=\"http://wx.qlogo.cn/mmhead/ver_1/ajX7IquRvt16WXDJYrYsBuGy5HoicQ1ibNbLKKHu744ic2WnxSaRtEQCgibSP8S2MdyIsqTWsKUUEZydsias9UR55nSQE7n6ibXChx4DQZQf5xh0M/132\" username=\"v1_183ca2ddb6369f35d74ea56046fcdf33d3a769352d9e125b44d26c18c0063ff537f6d66ea415db7648605aabf65b7b98@stranger\" nickname=\"LittleCoder机器人\"  shortpy=\"LITTLECODERJQR\" alias=\"\" imagestatus=\"3\" scene=\"17\" province=\"\" city=\"\" sign=\"\" sex=\"0\" certflag=\"0\" certinfo=\"\" brandIconUrl=\"\" brandHomeUrl=\"\" brandSubscriptConfigUrl=\"\" brandFlags=\"0\" regionCode=\"\" antispamticket=\"v2_6b780d55a1b949e161126df27729c85fd8b136d673ec7de475b0b5d811737502657129df8f19cd705cd90dc74bc12c09@stranger\" /&amp;gt;\n"</span>,</div><div class="line">    <span class="attr">"StatusNotifyUserName"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"FromUserName"</span>: <span class="string">"@a257b99314d8313862cd44ab02fe0f81"</span>,</div><div class="line">    <span class="attr">"OriContent"</span>: <span class="string">""</span>,</div><div class="line">    <span class="attr">"FileSize"</span>: <span class="string">""</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="如何使用-1"><a href="#如何使用-1" class="headerlink" title="如何使用"></a>如何使用</h2><p>如果你想引入自己的项目，请切换到<code>pom.xml</code>目录，执行<code>mvn package</code>命令，将生成的<code>itchat4j</code>的jar包收入即可。</p>
<h2 id="简单入门教程"><a href="#简单入门教程" class="headerlink" title="简单入门教程"></a>简单入门教程</h2><p><em>项目不断更新中，教程仅供参考</em></p>
<p>接下来，通过两个小Demo来演示一下如何使用itchat4j来扩展你的个人微信号，入门教程的项目源码可以从<a href="https://github.com/yaphone/itchat4jdemo" target="_blank" rel="external">此处下载</a>。</p>
<h3 id="Demo1-SimpleDemo"><a href="#Demo1-SimpleDemo" class="headerlink" title="Demo1: SimpleDemo"></a>Demo1: SimpleDemo</h3><p>这个小Demo将会将收到的文本消息发送给发件人，如果是图片、语音或者小视频消息，将会保存在我们指定的路径下。</p>
<p>首先需要新建一个类来实现<code>IMsgHandlerFace</code>这个接口，这个类要做的就是我们需要完成的逻辑，该接口有四个方法需要实现，<code>textMsgHandle</code>用于处理文本信息，<code>picMsgHandle</code>用于处理图片信息，<code>viedoMsgHandle</code>用于处理小视频信息，<code>voiceMsgHandle</code>用于处理语音信息，代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MsgHandler</span> <span class="keyword">implements</span> <span class="title">IMsgHandlerFace</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">picMsgHandle</span><span class="params">(JSONObject arg0)</span> </span>&#123;</div><div class="line">		<span class="comment">// TODO Auto-generated method stub</span></div><div class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">textMsgHandle</span><span class="params">(JSONObject arg0)</span> </span>&#123;</div><div class="line">		<span class="comment">// TODO Auto-generated method stub</span></div><div class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">viedoMsgHandle</span><span class="params">(JSONObject arg0)</span> </span>&#123;</div><div class="line">		<span class="comment">// TODO Auto-generated method stub</span></div><div class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">voiceMsgHandle</span><span class="params">(JSONObject arg0)</span> </span>&#123;</div><div class="line">		<span class="comment">// TODO Auto-generated method stub</span></div><div class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>由于没有关联源码，所以接口中的参数都变成了<code>arg0</code>这种，建议关联一下源码，源码可在<a href="https://github.com/yaphone/itchat4j/releases" target="_blank" rel="external">release</a>中下载，当然不关联也不会有啥影响，<code>arg0</code>其实是我们需要处理的消息体，为了更直观，建议把<code>arg0</code>修改为<code>msg</code>，msg是fastjson的JSONObject类型，这个其实不用关心，我们只需要知道如何来获取需要的消息就可以了，下面的Demo中有示例。然后我们来写处理逻辑。</p>
<p>在<code>textMsgHandler</code>中，通过<code>msg.getString(&quot;Text&quot;)</code>就可以获取收到的文本信息，然后作进一步处理，比如接入图灵机器人、消息自动回复等，我们需要在这个方法中返回一个字符串，即是需要回复给好友的消息，在SimpleDemo这个示例中，我们直接回复收到的原文本消息。</p>
<p>在<code>picMsgHandle</code>、<code>voiceMsgHandle</code>、<code>viedoMsgHandle</code>这三个方法中，我们需要将这些消息下载下来，然后再作进一步处理，所以需要为每种类型的消息提供一个保存路径，然后调用<code>DownloadTools.getDownloadFn</code>方法可以将这三种类型的消息下载下来。<code>DownloadTools.getDownloadFn</code>方法提供下载图片、语音、小视频的功能，需要三个参数，第一个参数为我们收到的msg，第二个参数为<code>MsgType</code>，也就是消息类型，图片、语音、小视频分别对应<code>MsgTypeEnum.PIC.getType()</code>、<code>MsgTypeEnum.VOICE.getType()</code>、<code>MsgTypeEnum.VIEDO.getType()</code>，然后第三个参数就是保存这些消息的路径了。</p>
<p>就不多说了，让代码和注释君自述吧，有不明白的地方，可以在Issue中提出来。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 简单示例程序，收到文本信息自动回复原信息，收到图片、语音、小视频后根据路径自动保存</div><div class="line"> * </div><div class="line"> * <span class="doctag">@author</span> https://github.com/yaphone</div><div class="line"> * <span class="doctag">@date</span> 创建时间：2017年4月25日 上午12:18:09</div><div class="line"> * <span class="doctag">@version</span> 1.0</div><div class="line"> *</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleDemo</span> <span class="keyword">implements</span> <span class="title">IMsgHandlerFace</span> </span>&#123;</div><div class="line">	Logger LOG = Logger.getLogger(SimpleDemo.class);</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">textMsgHandle</span><span class="params">(JSONObject msg)</span> </span>&#123;</div><div class="line">		String docFilePath = <span class="string">"D:/itchat4j/pic/test.docx"</span>; <span class="comment">// 这里是需要发送的文件的路径</span></div><div class="line">		<span class="keyword">if</span> (!msg.getBoolean(<span class="string">"groupMsg"</span>)) &#123; <span class="comment">// 群消息不处理</span></div><div class="line">			String userId = msg.getString(<span class="string">"FromUserName"</span>);</div><div class="line">			MessageTools.sendFileMsgByUserId(userId, docFilePath); <span class="comment">// 发送文件</span></div><div class="line">			String text = msg.getString(<span class="string">"Text"</span>); <span class="comment">// 发送文本消息，也可调用MessageTools.sendFileMsgByUserId(userId,text);</span></div><div class="line">			<span class="keyword">return</span> text;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">picMsgHandle</span><span class="params">(JSONObject msg)</span> </span>&#123;</div><div class="line">		String fileName = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd-HH-mm-ss"</span>).format(<span class="keyword">new</span> Date());<span class="comment">// 这里使用收到图片的时间作为文件名</span></div><div class="line">		String picPath = <span class="string">"D://itchat4j/pic"</span> + File.separator + fileName + <span class="string">".jpg"</span>; <span class="comment">// 调用此方法来保存图片</span></div><div class="line">		DownloadTools.getDownloadFn(msg, MsgTypeEnum.PIC.getType(), picPath); <span class="comment">// 保存图片的路径</span></div><div class="line">		<span class="keyword">return</span> <span class="string">"图片保存成功"</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">voiceMsgHandle</span><span class="params">(JSONObject msg)</span> </span>&#123;</div><div class="line">		String fileName = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd-HH-mm-ss"</span>).format(<span class="keyword">new</span> Date());</div><div class="line">		String voicePath = <span class="string">"D://itchat4j/voice"</span> + File.separator + fileName + <span class="string">".mp3"</span>;</div><div class="line">		DownloadTools.getDownloadFn(msg, MsgTypeEnum.VOICE.getType(), voicePath);</div><div class="line">		<span class="keyword">return</span> <span class="string">"声音保存成功"</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">viedoMsgHandle</span><span class="params">(JSONObject msg)</span> </span>&#123;</div><div class="line">		System.out.println(msg);</div><div class="line">		String fileName = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd-HH-mm-ss"</span>).format(<span class="keyword">new</span> Date());</div><div class="line">		String viedoPath = <span class="string">"D://itchat4j/viedo"</span> + File.separator + fileName + <span class="string">".mp4"</span>;</div><div class="line">		DownloadTools.getDownloadFn(msg, MsgTypeEnum.VIEDO.getType(), viedoPath);</div><div class="line">		<span class="keyword">return</span> <span class="string">"视频保存成功"</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">nameCardMsgHandle</span><span class="params">(JSONObject msg)</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="string">"收到名片消息"</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>之后我们需要将实现<code>IMsgHandlerFace</code>接口的类【注入】到<code>Wechat</code>中来启动服务，<code>Wechat</code>是服务的主入口，其构造函数接受两个参数，一个是我们刚才实现<code>IMsgHandlerFace</code>接口的类，另一个是保存登陆二维码图片的路径。之后在<code>Wechat</code>对象上调用<code>start()</code>方法来启动服务，会在我们刚才传入的路径下生成一个<code>QR.jpg</code>文件，即是登陆二维码，通过手机微信扫描后即可登陆，服务启动，处理逻辑开始工作。这里有一点需要注意：<em>二维码图片如果超过一定时间未扫描会过期，过期时会自动更新，所以你可能需要重新打开图片</em>。</p>
<p>额，文字还是太苍白，让代码和注释君自述吧。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * </div><div class="line"> * <span class="doctag">@author</span> https://github.com/yaphone</div><div class="line"> * <span class="doctag">@date</span> 创建时间：2017年4月28日 上午12:44:10</div><div class="line"> * <span class="doctag">@version</span> 1.0</div><div class="line"> *</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTest</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		String qrPath = <span class="string">"D://itchat4j//login"</span>; <span class="comment">// 保存登陆二维码图片的路径</span></div><div class="line">		IMsgHandlerFace msgHandler = <span class="keyword">new</span> SimpleDemo(); <span class="comment">// 实现IMsgHandlerFace接口的类</span></div><div class="line">		Wechat wechat = <span class="keyword">new</span> Wechat(msgHandler, qrPath); <span class="comment">// 【注入】</span></div><div class="line">		wechat.start(); <span class="comment">// 启动服务，会在qrPath下生成一张二维码图片，扫描即可登陆，注意，二维码图片如果超过一定时间未扫描会过期，过期时会自动更新，所以你可能需要重新打开图片</span></div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Demo2-图灵机器人"><a href="#Demo2-图灵机器人" class="headerlink" title="Demo2 图灵机器人"></a>Demo2 图灵机器人</h3><blockquote>
<p>图灵机器人大脑具备强大的中文语义分析能力，可准确理解中文含义并作出回应，是最擅长聊中文的机器人大脑，赋予软硬件产品自然流畅的人机对话能力。(引自百度百科)</p>
</blockquote>
<p>这个示例中我们接入图灵机器人的API，将收到的好友的文本信息发送给图灵机器人，并将机器人回复的消息发送给好友，接下来还是把舞台交代码和注释君吧。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 图灵机器人示例</div><div class="line"> * </div><div class="line"> * <span class="doctag">@author</span> https://github.com/yaphone</div><div class="line"> * <span class="doctag">@date</span> 创建时间：2017年4月24日 上午12:13:26</div><div class="line"> * <span class="doctag">@version</span> 1.0</div><div class="line"> *</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TulingRobot</span> <span class="keyword">implements</span> <span class="title">IMsgHandlerFace</span> </span>&#123;</div><div class="line">	MyHttpClient myHttpClient = Core.getInstance().getMyHttpClient();</div><div class="line">	String apiKey = <span class="string">"597b34bea4ec4c85a775c469c84b6817"</span>; <span class="comment">// 这里是我申请的图灵机器人API接口，每天只能5000次调用，建议自己去申请一个，免费的:)</span></div><div class="line">	Logger logger = Logger.getLogger(<span class="string">"TulingRobot"</span>);</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">textMsgHandle</span><span class="params">(JSONObject msg)</span> </span>&#123;</div><div class="line">		String result = <span class="string">""</span>;</div><div class="line">		String text = msg.getString(<span class="string">"Text"</span>);</div><div class="line">		String url = <span class="string">"http://www.tuling123.com/openapi/api"</span>;</div><div class="line">		Map&lt;String, String&gt; paramMap = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</div><div class="line">		paramMap.put(<span class="string">"key"</span>, apiKey);</div><div class="line">		paramMap.put(<span class="string">"info"</span>, text);</div><div class="line">		paramMap.put(<span class="string">"userid"</span>, <span class="string">"123456"</span>);</div><div class="line">		String paramStr = JSON.toJSONString(paramMap);</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			HttpEntity entity = myHttpClient.doPost(url, paramStr);</div><div class="line">			result = EntityUtils.toString(entity, <span class="string">"UTF-8"</span>);</div><div class="line">			JSONObject obj = JSON.parseObject(result);</div><div class="line">			<span class="keyword">if</span> (obj.getString(<span class="string">"code"</span>).equals(<span class="string">"100000"</span>)) &#123;</div><div class="line">				result = obj.getString(<span class="string">"text"</span>);</div><div class="line">			&#125; <span class="keyword">else</span> &#123;</div><div class="line">				result = <span class="string">"处理有误"</span>;</div><div class="line">			&#125;</div><div class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">			logger.info(e.getMessage());</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> result;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">picMsgHandle</span><span class="params">(JSONObject msg)</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="string">"收到图片"</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">voiceMsgHandle</span><span class="params">(JSONObject msg)</span> </span>&#123;</div><div class="line">		String fileName = String.valueOf(<span class="keyword">new</span> Date().getTime());</div><div class="line">		String voicePath = <span class="string">"D://itchat4j/voice"</span> + File.separator + fileName + <span class="string">".mp3"</span>;</div><div class="line">		DownloadTools.getDownloadFn(msg, MsgTypeEnum.VOICE.getType(), voicePath);</div><div class="line">		<span class="keyword">return</span> <span class="string">"收到语音"</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">viedoMsgHandle</span><span class="params">(JSONObject msg)</span> </span>&#123;</div><div class="line">		String fileName = String.valueOf(<span class="keyword">new</span> Date().getTime());</div><div class="line">		String viedoPath = <span class="string">"D://itchat4j/viedo"</span> + File.separator + fileName + <span class="string">".mp4"</span>;</div><div class="line">		DownloadTools.getDownloadFn(msg, MsgTypeEnum.VIEDO.getType(), viedoPath);</div><div class="line">		<span class="keyword">return</span> <span class="string">"收到视频"</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		IMsgHandlerFace msgHandler = <span class="keyword">new</span> TulingRobot();</div><div class="line">		Wechat wechat = <span class="keyword">new</span> Wechat(msgHandler, <span class="string">"D://itchat4j/login"</span>);</div><div class="line">		wechat.start();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">nameCardMsgHandle</span><span class="params">(JSONObject msg)</span> </span>&#123;</div><div class="line">		<span class="comment">// TODO Auto-generated method stub</span></div><div class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Demo3-itchat4j集成在SpringMVC应用中"><a href="#Demo3-itchat4j集成在SpringMVC应用中" class="headerlink" title="Demo3 itchat4j集成在SpringMVC应用中"></a>Demo3 itchat4j集成在SpringMVC应用中</h3><p>这个示例要讲起来就比较困难了，因为SpringMVC本身就是一个复杂的东西，先在这里挖个坑吧。其实在SpringMVC中集成与上面两个示例并没有太大的不同，我的个人博客是基于SpringMVC的，我已经将集成在这个项目里了，这样我就可以通过微信来更新我的博客了。详细的就不多说了，大家先看看这个项目结构吧。</p>
<p><img src="http://oj5vdtyuu.bkt.clouddn.com/itchat4j%E9%9B%86%E6%88%90%E5%9C%A8blog%E9%A1%B9%E7%9B%AE%E4%B8%AD%E4%BF%AE%E6%94%B9%E5%90%8E.jpg" alt="itchat4j集成在Blog项目"></p>
<p>其中<code>MsgHandler</code>就是我处理微信消息的逻辑，略复杂，就不贴代码了。<code>WechatService</code>就是将<code>MsgHandler</code>“注入”到<code>Wechat</code>类中，与上面两个示例的作用是一样的，贴一下<code>WechatService</code>的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Wechat服务实现类</div><div class="line"> * </div><div class="line"> * <span class="doctag">@author</span> https://github.com/yaphone</div><div class="line"> * <span class="doctag">@date</span> 创建时间：2017年4月29日 下午7:44:01</div><div class="line"> * <span class="doctag">@version</span> 1.0</div><div class="line"> *</div><div class="line"> */</div><div class="line"><span class="meta">@Service</span>(<span class="string">"wechatService"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WechatService</span> <span class="keyword">implements</span> <span class="title">IWechatServiceFace</span> </span>&#123;</div><div class="line">	<span class="meta">@Value</span>(<span class="string">"$&#123;qrPath&#125;"</span>)</div><div class="line">	<span class="keyword">private</span> String qrPath;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">()</span> </span>&#123;</div><div class="line">		MsgHandler msgHandler = <span class="keyword">new</span> MsgHandler();</div><div class="line">		Wechat wechat = <span class="keyword">new</span> Wechat(msgHandler, qrPath);</div><div class="line">		wechat.start();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="类似项目"><a href="#类似项目" class="headerlink" title="类似项目"></a>类似项目</h2><p><a href="https://github.com/littlecodersh/ItChat" target="_blank" rel="external">itchat</a> ：优秀的、基于Python的微信个人号API，同时也是本项目的灵感之源。</p>
<p><a href="https://github.com/Urinx/WeixinBot" target="_blank" rel="external">WeixinBot</a>: 网页版微信API，包含终端版微信及微信机器人</p>
<h2 id="鸣谢："><a href="#鸣谢：" class="headerlink" title="鸣谢："></a>鸣谢：</h2><p>itchat4j开源后，收到很多朋友的建议，对ithcat4j改进做出了很多帮助，在此表示感谢！</p>
<p><a href="https://github.com/jasonTangxd?tab=overview&amp;from=2017-05-15" target="_blank" rel="external">@jasonTangxd</a>，项目结构调整。</p>
<p><a href="https://github.com/libre818" target="_blank" rel="external">@libre818</a>。</p>
<p>@QQ群好友（北极心 851668663）,增加修改好友备注名方法。</p>
<p>@QQ群好友（beyond_12345@126.com）</p>
<h2 id="问题和建议"><a href="#问题和建议" class="headerlink" title="问题和建议"></a>问题和建议</h2><p>本项目长期更新、维护，功能不断扩展与完善中，欢迎star。</p>
<p>项目使用过程中遇到问题，或者有好的建议，欢迎随时反馈。</p>
<p>任何问题或者建议都可以在Issue中提出来，也可以加入QQ群讨论：636365179</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/06/10/itchat4j/" data-id="cj3qpqyny000184vmqlyatlhq" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/06/10/test/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Récent</strong>
      <div class="article-nav-title">
        
          测试
        
      </div>
    </a>
  
  
    <a href="/2017/06/10/hello-world/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Ancien</strong>
      <div class="article-nav-title">Hello World</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Articles récents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/06/10/test/">测试</a>
          </li>
        
          <li>
            <a href="/2017/06/10/itchat4j/">itchat4j -- 用Java扩展个人微信号的能力</a>
          </li>
        
          <li>
            <a href="/2017/06/10/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 yaphone<br>
      Propulsé by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>